{
  "hash": "62a32f1f51e9028188623cb630df62f1",
  "result": {
    "markdown": "---\ntitle: <b>Support Vector Machine Classifier for Record Data</b>\nformat:\n  html:\n    theme: lumen\n    toc: true\n    self-contained: true\n    embed-resources: true\n    page-layout: full\n    code-fold: true\n    code-tools: true\n---\n\n# Import Libraries\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom scipy import stats\n\nfrom sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay\nfrom sklearn.model_selection import train_test_split, GridSearchCV\nfrom sklearn.svm import SVC\nfrom sklearn.metrics import classification_report\nfrom sklearn.preprocessing import OneHotEncoder, StandardScaler\n\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.metrics import confusion_matrix, plot_confusion_matrix,\\\n    precision_score, recall_score, accuracy_score, f1_score, log_loss,\\\n    roc_curve, roc_auc_score, classification_report\nfrom sklearn.pipeline import Pipeline, FeatureUnion, make_pipeline\nfrom sklearn.compose import ColumnTransformer\n\nimport warnings \nwarnings.filterwarnings(\"ignore\")\n```\n:::\n\n\n# Import Data\n- Cleaned record data is considered to perform SVM supervised learning algorithm and predict the label variable (Podium, Top 10 or Outside Top 10).\n- The data consists of 26,941 rows and 22 feature variables and 1 label column.\n- It is a historical record data of all the races that have happened in the past 71 years with the results of every position that a driver has held in all the races.\n- Some of the feature variables include laps in the race, grid position held, age at time of the race, history of wins in the past, history of laps completed in the past, weather of the race, points gained in the race and many more.\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\ndf = pd.read_csv('../../data/02-model-data/data_cleaned.csv')\ndf.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>season</th>\n      <th>round</th>\n      <th>season_round</th>\n      <th>driverId</th>\n      <th>raceId</th>\n      <th>circuitId</th>\n      <th>position</th>\n      <th>points</th>\n      <th>grid</th>\n      <th>laps</th>\n      <th>...</th>\n      <th>weather</th>\n      <th>stop</th>\n      <th>age_on_race</th>\n      <th>cumulative_points</th>\n      <th>cumulative_laps</th>\n      <th>pole_driverId</th>\n      <th>pole_history</th>\n      <th>win_driverId</th>\n      <th>win_history</th>\n      <th>label</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1950</td>\n      <td>1</td>\n      <td>1950_1</td>\n      <td>642</td>\n      <td>833</td>\n      <td>9</td>\n      <td>1</td>\n      <td>9.0</td>\n      <td>1</td>\n      <td>70</td>\n      <td>...</td>\n      <td>Fine</td>\n      <td>Not Available</td>\n      <td>44</td>\n      <td>9.0</td>\n      <td>70</td>\n      <td>642</td>\n      <td>1</td>\n      <td>642</td>\n      <td>1</td>\n      <td>Podium</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1950</td>\n      <td>1</td>\n      <td>1950_1</td>\n      <td>786</td>\n      <td>833</td>\n      <td>9</td>\n      <td>2</td>\n      <td>6.0</td>\n      <td>2</td>\n      <td>70</td>\n      <td>...</td>\n      <td>Fine</td>\n      <td>Not Available</td>\n      <td>52</td>\n      <td>6.0</td>\n      <td>70</td>\n      <td>642</td>\n      <td>0</td>\n      <td>642</td>\n      <td>0</td>\n      <td>Podium</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1950</td>\n      <td>1</td>\n      <td>1950_1</td>\n      <td>686</td>\n      <td>833</td>\n      <td>9</td>\n      <td>3</td>\n      <td>4.0</td>\n      <td>4</td>\n      <td>70</td>\n      <td>...</td>\n      <td>Fine</td>\n      <td>Not Available</td>\n      <td>39</td>\n      <td>4.0</td>\n      <td>70</td>\n      <td>642</td>\n      <td>0</td>\n      <td>642</td>\n      <td>0</td>\n      <td>Podium</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1950</td>\n      <td>1</td>\n      <td>1950_1</td>\n      <td>704</td>\n      <td>833</td>\n      <td>9</td>\n      <td>4</td>\n      <td>3.0</td>\n      <td>6</td>\n      <td>68</td>\n      <td>...</td>\n      <td>Fine</td>\n      <td>Not Available</td>\n      <td>46</td>\n      <td>3.0</td>\n      <td>68</td>\n      <td>642</td>\n      <td>0</td>\n      <td>642</td>\n      <td>0</td>\n      <td>Top_10</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1950</td>\n      <td>1</td>\n      <td>1950_1</td>\n      <td>627</td>\n      <td>833</td>\n      <td>9</td>\n      <td>5</td>\n      <td>2.0</td>\n      <td>9</td>\n      <td>68</td>\n      <td>...</td>\n      <td>Fine</td>\n      <td>Not Available</td>\n      <td>45</td>\n      <td>2.0</td>\n      <td>68</td>\n      <td>642</td>\n      <td>0</td>\n      <td>642</td>\n      <td>0</td>\n      <td>Top_10</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 22 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\ndriver_df = pd.read_csv('../../data/00-raw-data/drivers.csv')\ndriver_df.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>driverId</th>\n      <th>driverRef</th>\n      <th>number</th>\n      <th>code</th>\n      <th>forename</th>\n      <th>surname</th>\n      <th>dob</th>\n      <th>nationality</th>\n      <th>url</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>hamilton</td>\n      <td>44</td>\n      <td>HAM</td>\n      <td>Lewis</td>\n      <td>Hamilton</td>\n      <td>1985-01-07</td>\n      <td>British</td>\n      <td>http://en.wikipedia.org/wiki/Lewis_Hamilton</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n      <td>heidfeld</td>\n      <td>\\N</td>\n      <td>HEI</td>\n      <td>Nick</td>\n      <td>Heidfeld</td>\n      <td>1977-05-10</td>\n      <td>German</td>\n      <td>http://en.wikipedia.org/wiki/Nick_Heidfeld</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>3</td>\n      <td>rosberg</td>\n      <td>6</td>\n      <td>ROS</td>\n      <td>Nico</td>\n      <td>Rosberg</td>\n      <td>1985-06-27</td>\n      <td>German</td>\n      <td>http://en.wikipedia.org/wiki/Nico_Rosberg</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>4</td>\n      <td>alonso</td>\n      <td>14</td>\n      <td>ALO</td>\n      <td>Fernando</td>\n      <td>Alonso</td>\n      <td>1981-07-29</td>\n      <td>Spanish</td>\n      <td>http://en.wikipedia.org/wiki/Fernando_Alonso</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>5</td>\n      <td>kovalainen</td>\n      <td>\\N</td>\n      <td>KOV</td>\n      <td>Heikki</td>\n      <td>Kovalainen</td>\n      <td>1981-10-19</td>\n      <td>Finnish</td>\n      <td>http://en.wikipedia.org/wiki/Heikki_Kovalainen</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\ndf = pd.merge(df, driver_df[['driverId', 'driverRef']], on='driverId')\n```\n:::\n\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\ndf.shape\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\n(26941, 23)\n```\n:::\n:::\n\n\n# Data Pre-Processing and Visualization\n- The data was cleaned in the sections before but there are still some pre-processing left to be in order for the data to be \"model-ready\".\n- Some unnecessary columns are dropped and columns are segregated into numeric and categorical sections.\n- The numerical columns are scaled using a Standard Scaler and the categorical columns are one hot encoded to minimize loss of data. All of this is done with the help of a function which use sklearn's Pipeline module.\n- If a transformer and model estimator are applied separately, it will result in fitted training features being wrongly included in the test-fold of GridSearchCV.\n- Pipelines help avoid leaking statistics from your test data into the trained model in cross-validation, by ensuring that the same samples are used to train the transformers and predictors.\n- If you separate feature scaling and model-fitting functions while using GridSearchCV, you will be creating a biased testing dataset that already contains information about the training set which is not good.\n- Furthermore, the data is split into training and testing but not traditionally (with the help of sklearn's train_test_split). The training set is made up of races before 2021 and the testing is done on the races of 2021.\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\ndf.drop(['season_round', 'constructorRef', 'raceId', 'driverId'], axis=1, inplace=True)\n```\n:::\n\n\n::: {.cell execution_count=7}\n``` {.python .cell-code}\ndf.info()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<class 'pandas.core.frame.DataFrame'>\nInt64Index: 26941 entries, 0 to 26940\nData columns (total 19 columns):\n #   Column             Non-Null Count  Dtype  \n---  ------             --------------  -----  \n 0   season             26941 non-null  int64  \n 1   round              26941 non-null  int64  \n 2   circuitId          26941 non-null  int64  \n 3   position           26941 non-null  int64  \n 4   points             26941 non-null  float64\n 5   grid               26941 non-null  int64  \n 6   laps               26941 non-null  int64  \n 7   status             26941 non-null  object \n 8   weather            26941 non-null  object \n 9   stop               26941 non-null  object \n 10  age_on_race        26941 non-null  int64  \n 11  cumulative_points  26941 non-null  float64\n 12  cumulative_laps    26941 non-null  int64  \n 13  pole_driverId      26941 non-null  int64  \n 14  pole_history       26941 non-null  int64  \n 15  win_driverId       26941 non-null  int64  \n 16  win_history        26941 non-null  int64  \n 17  label              26941 non-null  object \n 18  driverRef          26941 non-null  object \ndtypes: float64(2), int64(12), object(5)\nmemory usage: 4.1+ MB\n```\n:::\n:::\n\n\n::: {.cell execution_count=8}\n``` {.python .cell-code}\ndf.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>season</th>\n      <th>round</th>\n      <th>circuitId</th>\n      <th>position</th>\n      <th>points</th>\n      <th>grid</th>\n      <th>laps</th>\n      <th>status</th>\n      <th>weather</th>\n      <th>stop</th>\n      <th>age_on_race</th>\n      <th>cumulative_points</th>\n      <th>cumulative_laps</th>\n      <th>pole_driverId</th>\n      <th>pole_history</th>\n      <th>win_driverId</th>\n      <th>win_history</th>\n      <th>label</th>\n      <th>driverRef</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1950</td>\n      <td>1</td>\n      <td>9</td>\n      <td>1</td>\n      <td>9.0</td>\n      <td>1</td>\n      <td>70</td>\n      <td>Finished</td>\n      <td>Fine</td>\n      <td>Not Available</td>\n      <td>44</td>\n      <td>9.0</td>\n      <td>70</td>\n      <td>642</td>\n      <td>1</td>\n      <td>642</td>\n      <td>1</td>\n      <td>Podium</td>\n      <td>farina</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1950</td>\n      <td>2</td>\n      <td>6</td>\n      <td>11</td>\n      <td>0.0</td>\n      <td>2</td>\n      <td>0</td>\n      <td>Accident</td>\n      <td>Not Available</td>\n      <td>Not Available</td>\n      <td>44</td>\n      <td>9.0</td>\n      <td>70</td>\n      <td>579</td>\n      <td>1</td>\n      <td>579</td>\n      <td>1</td>\n      <td>Outside_Top_10</td>\n      <td>farina</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1950</td>\n      <td>4</td>\n      <td>66</td>\n      <td>1</td>\n      <td>9.0</td>\n      <td>2</td>\n      <td>42</td>\n      <td>Finished</td>\n      <td>Sunny</td>\n      <td>Not Available</td>\n      <td>44</td>\n      <td>18.0</td>\n      <td>112</td>\n      <td>579</td>\n      <td>1</td>\n      <td>642</td>\n      <td>2</td>\n      <td>Podium</td>\n      <td>farina</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1950</td>\n      <td>5</td>\n      <td>13</td>\n      <td>4</td>\n      <td>4.0</td>\n      <td>1</td>\n      <td>35</td>\n      <td>Finished</td>\n      <td>Sunny</td>\n      <td>Not Available</td>\n      <td>44</td>\n      <td>22.0</td>\n      <td>147</td>\n      <td>642</td>\n      <td>2</td>\n      <td>579</td>\n      <td>2</td>\n      <td>Top_10</td>\n      <td>farina</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1950</td>\n      <td>6</td>\n      <td>55</td>\n      <td>7</td>\n      <td>0.0</td>\n      <td>2</td>\n      <td>55</td>\n      <td>Mechanical_Issue</td>\n      <td>Sunny</td>\n      <td>Not Available</td>\n      <td>44</td>\n      <td>22.0</td>\n      <td>202</td>\n      <td>579</td>\n      <td>2</td>\n      <td>579</td>\n      <td>2</td>\n      <td>Top_10</td>\n      <td>farina</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=9}\n``` {.python .cell-code}\ndf = df[df['season'] != 2022]\n```\n:::\n\n\nSplitting data into train and test:\n\n::: {.cell execution_count=10}\n``` {.python .cell-code}\nX_train = df[df['season'] != 2021].drop(columns = ['label'])\ny_train = df.loc[df['season'] != 2021, ['season', 'round', 'driverRef', 'label']]\nX_test = df[df['season'] == 2021].drop(columns = ['label'])\ny_test = df.loc[(df['season'] == 2021), ['season', 'round', 'driverRef', 'label']]\n```\n:::\n\n\nGrouping the data by setting the index of train and test data into season, round and driver references:\n\n::: {.cell execution_count=11}\n``` {.python .cell-code}\nX_train = X_train.set_index(['season', 'round', 'driverRef'])\ny_train = y_train.set_index(['season', 'round', 'driverRef'])\nX_test = X_test.set_index(['season', 'round', 'driverRef'])\ny_test = y_test.set_index(['season', 'round', 'driverRef'])\n```\n:::\n\n\n::: {.cell execution_count=12}\n``` {.python .cell-code}\nnumeric_features = ['circuitId', 'position', 'points', 'grid', 'laps', 'age_on_race', 'cumulative_points', 'cumulative_laps',\n       'pole_driverId', 'pole_history', 'win_driverId', 'win_history']\n\ncategorical_features = ['status', 'weather', 'stop']\n```\n:::\n\n\n::: {.cell execution_count=13}\n``` {.python .cell-code}\ndisplay(X_test.head())\ndisplay(y_test.head())\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th></th>\n      <th>circuitId</th>\n      <th>position</th>\n      <th>points</th>\n      <th>grid</th>\n      <th>laps</th>\n      <th>status</th>\n      <th>weather</th>\n      <th>stop</th>\n      <th>age_on_race</th>\n      <th>cumulative_points</th>\n      <th>cumulative_laps</th>\n      <th>pole_driverId</th>\n      <th>pole_history</th>\n      <th>win_driverId</th>\n      <th>win_history</th>\n    </tr>\n    <tr>\n      <th>season</th>\n      <th>round</th>\n      <th>driverRef</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"5\" valign=\"top\">2021</th>\n      <th>1</th>\n      <th>raikkonen</th>\n      <td>3</td>\n      <td>11</td>\n      <td>0.0</td>\n      <td>14</td>\n      <td>56</td>\n      <td>Finished</td>\n      <td>Sunny</td>\n      <td>Two</td>\n      <td>42</td>\n      <td>1863.0</td>\n      <td>17613</td>\n      <td>830</td>\n      <td>18</td>\n      <td>1</td>\n      <td>21</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <th>raikkonen</th>\n      <td>21</td>\n      <td>13</td>\n      <td>0.0</td>\n      <td>16</td>\n      <td>63</td>\n      <td>Finished</td>\n      <td>Rainy</td>\n      <td>Three</td>\n      <td>42</td>\n      <td>1863.0</td>\n      <td>17676</td>\n      <td>1</td>\n      <td>18</td>\n      <td>830</td>\n      <td>21</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <th>raikkonen</th>\n      <td>75</td>\n      <td>20</td>\n      <td>0.0</td>\n      <td>15</td>\n      <td>1</td>\n      <td>Mechanical_Issue</td>\n      <td>Cloudy</td>\n      <td>Not Available</td>\n      <td>42</td>\n      <td>1863.0</td>\n      <td>17677</td>\n      <td>822</td>\n      <td>18</td>\n      <td>1</td>\n      <td>21</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <th>raikkonen</th>\n      <td>4</td>\n      <td>12</td>\n      <td>0.0</td>\n      <td>17</td>\n      <td>65</td>\n      <td>Lapped</td>\n      <td>Cloudy</td>\n      <td>One</td>\n      <td>42</td>\n      <td>1863.0</td>\n      <td>17742</td>\n      <td>1</td>\n      <td>18</td>\n      <td>1</td>\n      <td>21</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <th>raikkonen</th>\n      <td>6</td>\n      <td>11</td>\n      <td>0.0</td>\n      <td>14</td>\n      <td>77</td>\n      <td>Lapped</td>\n      <td>Sunny</td>\n      <td>One</td>\n      <td>42</td>\n      <td>1863.0</td>\n      <td>17819</td>\n      <td>844</td>\n      <td>18</td>\n      <td>830</td>\n      <td>21</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th></th>\n      <th>label</th>\n    </tr>\n    <tr>\n      <th>season</th>\n      <th>round</th>\n      <th>driverRef</th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"5\" valign=\"top\">2021</th>\n      <th>1</th>\n      <th>raikkonen</th>\n      <td>Outside_Top_10</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <th>raikkonen</th>\n      <td>Outside_Top_10</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <th>raikkonen</th>\n      <td>Outside_Top_10</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <th>raikkonen</th>\n      <td>Outside_Top_10</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <th>raikkonen</th>\n      <td>Outside_Top_10</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nCreating a function with sklearn's Pipeline module and transformers to convert categorical and numerical features:\n\n::: {.cell execution_count=14}\n``` {.python .cell-code}\ndef prediction_model(model_type, model_id):\n    # Scale numeric features using 'StandardScaler' and 'One-Hot Encode' categorical features\n    scoring = ['neg_log_loss', 'accuracy']\n    numeric_transformer = Pipeline(steps=[('scaler', StandardScaler())])\n    categorical_transformer = Pipeline(steps=[('ohe', OneHotEncoder(handle_unknown = 'ignore'))])\n    preprocessor = ColumnTransformer(transformers=[('num', numeric_transformer, numeric_features),\n                                                   ('cat', categorical_transformer, categorical_features)])\n    pipeline = Pipeline(steps=[('prep', preprocessor), \n                               (model_id, model_type)])\n    return pipeline\n```\n:::\n\n\n# SVM\n- `Support Vector Machines` are a set of supervised learning methods used for classification, regression, and outliers detection. All of these are common tasks in machine learning.\n- There are specific types of SVMs you can use for particular machine learning problems, like support vector regression (SVR) which is an extension of support vector classification (SVC).\n- SVMs are different from other classification algorithms because of the way they choose the decision boundary that maximizes the distance from the nearest data points of all the classes. The decision boundary created by SVMs is called the maximum margin classifier or the maximum margin hyper plane.\n- A simple linear SVM classifier works by making a straight line between two classes. That means all of the data points on one side of the line will represent a category and the data points on the other side of the line will be put into a different category. This means there can be an infinite number of lines to choose from.\n- What makes the linear SVM algorithm better than some of the other algorithms, like k-nearest neighbors, is that it chooses the best line to classify your data points. It chooses the line that separates the data and is the furthest away from the closet data points as possible.\n- Pros\n    - Effective on datasets with multiple features, like financial or medical data.\n    - Uses a subset of training points in the decision function called support vectors which makes it memory efficient.\n    - Different kernel functions can be specified for the decision function. You can use common kernels, but it's also possible to specify custom kernels.\n- Cons\n    - If the number of features is a lot bigger than the number of data points, avoiding over-fitting when choosing kernel functions and regularization term is crucial.\n    - SVMs don't directly provide probability estimates. Those are calculated using an expensive five-fold cross-validation.\n    - Works best on small sample sets because of its high training time.\n\n## Model Prediction function\n- After fitting the model it is important to showcase and visualize the model classification results.\n- The model_results function predicts the model results on test data (2021 races). It displays out the 40 results from the test data along with the prediction probabilities. \n- The function also fills the prediction scorecard dictionary which contains:\n    1. Model\n    2. Accuracy\n    3. Precision\n    4. Recall\n    5. Best parameters\n\n::: {.cell execution_count=15}\n``` {.python .cell-code}\nprediction_scorecard = {'model':[],\n                        'accuracy_score':[],\n                        'precision_score':[],\n                        'recall_score':[],\n                        'best_params':[]}\n```\n:::\n\n\n::: {.cell execution_count=16}\n``` {.python .cell-code}\ndef model_results(X_test, model, model_id):\n    # Predict!\n    pred = model.predict(X_test)\n    pred_proba = model.predict_proba(X_test)\n    df_pred = pd.DataFrame(np.around(pred_proba, 4), index=X_test.index, columns=['prob_0', 'prob_1', 'prob_2'])\n    df_pred['prediction'] = list(pred)\n    df_pred['actual'] = y_test['label']\n    df_pred['grid_position'] = X_test['grid']\n\n    # Include row if an 'actual' or 'predicted' podium occured for calculating accuracy\n    # df_pred['sort'] = df_pred['prediction'] + df_pred['actual']\n    # df_pred = df_pred[df_pred['sort'] > 0]\n    # df_pred.reset_index(inplace=True)\n    df_pred = df_pred.groupby(['round']).apply(pd.DataFrame.sort_values, 'prob_1', ascending=False)\n    # df_pred.drop(['sort'], axis=1, inplace=True)\n    # df_pred.reset_index(drop=True, inplace=True) \n    \n    # Save Accuracy, Precision, \n    prediction_scorecard['model'].append(model_id)\n    prediction_scorecard['accuracy_score'].append(accuracy_score(df_pred['actual'], df_pred['prediction']))\n    prediction_scorecard['precision_score'].append(precision_score(df_pred['actual'], df_pred['prediction'], average='micro'))\n    prediction_scorecard['recall_score'].append(recall_score(df_pred['actual'], df_pred['prediction'], average='micro'))\n    prediction_scorecard['best_params'].append(str(model.best_params_))\n    display(df_pred.head(40))\n```\n:::\n\n\n## Grid search CV\n- Hyper-parameters are variables that you specify while building a machine-learning model. This means that it’s the user that defines the hyper-parameters while building the model. Hyper-parameters control the learning process, while parameters are learned.\n- The performance of a model significantly depends on the value of hyperparameters. Note that there is no way to know in advance the best values for hyperparameters so ideally, we need to try all possible values to know the optimal values. \n- Doing this manually could take a considerable amount of time and resources and thus we use GridSearchCV to automate the tuning of hyperparameters.\n- Grid search CV of the sklearn library is a module for hyperparameter tuning.\n- It runs through all the different parameters that is fed into the parameter grid and produces the best combination of parameters, based on a scoring metric of your choice (accuracy, f1, etc).\n- GridSearchCV tries all the combinations of the values passed in the dictionary and evaluates the model for each combination using the Cross-Validation method.\n- The process is time consuming.\n\n::: {.cell execution_count=17}\n``` {.python .cell-code}\nsvm_params= {'svm__C': [0.1],\n             'svm__kernel': ['linear', 'poly'],\n             'svm__degree': [2, 3],\n             'svm__gamma': [0.01]}\n```\n:::\n\n\nTypes of SVM Kernels: <br>\n- `Linear`: These are commonly recommended for text classification because most of these types of classification problems are linearly separable.<br>\n- `Polynomial`: The polynomial kernel isn't used in practice very often because it isn't as computationally efficient as other kernels and its predictions aren't as accurate.<br>\n- `Gaussian Radial Basis Function (RBF)`: One of the most powerful and commonly used kernels in SVMs. Usually the choice for non-linear data.\n\n::: {.cell execution_count=18}\n``` {.python .cell-code}\nscoring = ['neg_log_loss', 'accuracy']\n\nsvm_cv = GridSearchCV(prediction_model(SVC(probability=True), 'svm'),\n                      param_grid=svm_params,\n                      scoring=scoring, \n                      refit='neg_log_loss',  \n                      verbose=0)\n```\n:::\n\n\n## Fitting and Training the SVM model\n\n::: {.cell execution_count=19}\n``` {.python .cell-code}\n# Train Model\nsvm_cv.fit(X_train, y_train)\n```\n\n::: {.cell-output .cell-output-display execution_count=19}\n```{=html}\n<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GridSearchCV(estimator=Pipeline(steps=[(&#x27;prep&#x27;,\n                                        ColumnTransformer(transformers=[(&#x27;num&#x27;,\n                                                                         Pipeline(steps=[(&#x27;scaler&#x27;,\n                                                                                          StandardScaler())]),\n                                                                         [&#x27;circuitId&#x27;,\n                                                                          &#x27;position&#x27;,\n                                                                          &#x27;points&#x27;,\n                                                                          &#x27;grid&#x27;,\n                                                                          &#x27;laps&#x27;,\n                                                                          &#x27;age_on_race&#x27;,\n                                                                          &#x27;cumulative_points&#x27;,\n                                                                          &#x27;cumulative_laps&#x27;,\n                                                                          &#x27;pole_driverId&#x27;,\n                                                                          &#x27;pole_history&#x27;,\n                                                                          &#x27;win_driverId&#x27;,\n                                                                          &#x27;win_history&#x27;]),\n                                                                        (&#x27;cat&#x27;,\n                                                                         Pipeline(steps=[(&#x27;ohe&#x27;,\n                                                                                          OneHotEncoder(handle_unknown=&#x27;ignore&#x27;))]),\n                                                                         [&#x27;status&#x27;,\n                                                                          &#x27;weather&#x27;,\n                                                                          &#x27;stop&#x27;])])),\n                                       (&#x27;svm&#x27;, SVC(probability=True))]),\n             param_grid={&#x27;svm__C&#x27;: [0.1], &#x27;svm__degree&#x27;: [2, 3],\n                         &#x27;svm__gamma&#x27;: [0.01],\n                         &#x27;svm__kernel&#x27;: [&#x27;linear&#x27;, &#x27;poly&#x27;]},\n             refit=&#x27;neg_log_loss&#x27;, scoring=[&#x27;neg_log_loss&#x27;, &#x27;accuracy&#x27;])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" ><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GridSearchCV</label><div class=\"sk-toggleable__content\"><pre>GridSearchCV(estimator=Pipeline(steps=[(&#x27;prep&#x27;,\n                                        ColumnTransformer(transformers=[(&#x27;num&#x27;,\n                                                                         Pipeline(steps=[(&#x27;scaler&#x27;,\n                                                                                          StandardScaler())]),\n                                                                         [&#x27;circuitId&#x27;,\n                                                                          &#x27;position&#x27;,\n                                                                          &#x27;points&#x27;,\n                                                                          &#x27;grid&#x27;,\n                                                                          &#x27;laps&#x27;,\n                                                                          &#x27;age_on_race&#x27;,\n                                                                          &#x27;cumulative_points&#x27;,\n                                                                          &#x27;cumulative_laps&#x27;,\n                                                                          &#x27;pole_driverId&#x27;,\n                                                                          &#x27;pole_history&#x27;,\n                                                                          &#x27;win_driverId&#x27;,\n                                                                          &#x27;win_history&#x27;]),\n                                                                        (&#x27;cat&#x27;,\n                                                                         Pipeline(steps=[(&#x27;ohe&#x27;,\n                                                                                          OneHotEncoder(handle_unknown=&#x27;ignore&#x27;))]),\n                                                                         [&#x27;status&#x27;,\n                                                                          &#x27;weather&#x27;,\n                                                                          &#x27;stop&#x27;])])),\n                                       (&#x27;svm&#x27;, SVC(probability=True))]),\n             param_grid={&#x27;svm__C&#x27;: [0.1], &#x27;svm__degree&#x27;: [2, 3],\n                         &#x27;svm__gamma&#x27;: [0.01],\n                         &#x27;svm__kernel&#x27;: [&#x27;linear&#x27;, &#x27;poly&#x27;]},\n             refit=&#x27;neg_log_loss&#x27;, scoring=[&#x27;neg_log_loss&#x27;, &#x27;accuracy&#x27;])</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-2\" type=\"checkbox\" ><label for=\"sk-estimator-id-2\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">estimator: Pipeline</label><div class=\"sk-toggleable__content\"><pre>Pipeline(steps=[(&#x27;prep&#x27;,\n                 ColumnTransformer(transformers=[(&#x27;num&#x27;,\n                                                  Pipeline(steps=[(&#x27;scaler&#x27;,\n                                                                   StandardScaler())]),\n                                                  [&#x27;circuitId&#x27;, &#x27;position&#x27;,\n                                                   &#x27;points&#x27;, &#x27;grid&#x27;, &#x27;laps&#x27;,\n                                                   &#x27;age_on_race&#x27;,\n                                                   &#x27;cumulative_points&#x27;,\n                                                   &#x27;cumulative_laps&#x27;,\n                                                   &#x27;pole_driverId&#x27;,\n                                                   &#x27;pole_history&#x27;,\n                                                   &#x27;win_driverId&#x27;,\n                                                   &#x27;win_history&#x27;]),\n                                                 (&#x27;cat&#x27;,\n                                                  Pipeline(steps=[(&#x27;ohe&#x27;,\n                                                                   OneHotEncoder(handle_unknown=&#x27;ignore&#x27;))]),\n                                                  [&#x27;status&#x27;, &#x27;weather&#x27;,\n                                                   &#x27;stop&#x27;])])),\n                (&#x27;svm&#x27;, SVC(probability=True))])</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-serial\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-3\" type=\"checkbox\" ><label for=\"sk-estimator-id-3\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">prep: ColumnTransformer</label><div class=\"sk-toggleable__content\"><pre>ColumnTransformer(transformers=[(&#x27;num&#x27;,\n                                 Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler())]),\n                                 [&#x27;circuitId&#x27;, &#x27;position&#x27;, &#x27;points&#x27;, &#x27;grid&#x27;,\n                                  &#x27;laps&#x27;, &#x27;age_on_race&#x27;, &#x27;cumulative_points&#x27;,\n                                  &#x27;cumulative_laps&#x27;, &#x27;pole_driverId&#x27;,\n                                  &#x27;pole_history&#x27;, &#x27;win_driverId&#x27;,\n                                  &#x27;win_history&#x27;]),\n                                (&#x27;cat&#x27;,\n                                 Pipeline(steps=[(&#x27;ohe&#x27;,\n                                                  OneHotEncoder(handle_unknown=&#x27;ignore&#x27;))]),\n                                 [&#x27;status&#x27;, &#x27;weather&#x27;, &#x27;stop&#x27;])])</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-4\" type=\"checkbox\" ><label for=\"sk-estimator-id-4\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">num</label><div class=\"sk-toggleable__content\"><pre>[&#x27;circuitId&#x27;, &#x27;position&#x27;, &#x27;points&#x27;, &#x27;grid&#x27;, &#x27;laps&#x27;, &#x27;age_on_race&#x27;, &#x27;cumulative_points&#x27;, &#x27;cumulative_laps&#x27;, &#x27;pole_driverId&#x27;, &#x27;pole_history&#x27;, &#x27;win_driverId&#x27;, &#x27;win_history&#x27;]</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-5\" type=\"checkbox\" ><label for=\"sk-estimator-id-5\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">StandardScaler</label><div class=\"sk-toggleable__content\"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-6\" type=\"checkbox\" ><label for=\"sk-estimator-id-6\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">cat</label><div class=\"sk-toggleable__content\"><pre>[&#x27;status&#x27;, &#x27;weather&#x27;, &#x27;stop&#x27;]</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-7\" type=\"checkbox\" ><label for=\"sk-estimator-id-7\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">OneHotEncoder</label><div class=\"sk-toggleable__content\"><pre>OneHotEncoder(handle_unknown=&#x27;ignore&#x27;)</pre></div></div></div></div></div></div></div></div></div></div><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-8\" type=\"checkbox\" ><label for=\"sk-estimator-id-8\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">SVC</label><div class=\"sk-toggleable__content\"><pre>SVC(probability=True)</pre></div></div></div></div></div></div></div></div></div></div></div></div>\n```\n:::\n:::\n\n\n## Testing the SVM model\n\n::: {.cell execution_count=20}\n``` {.python .cell-code}\n# Test Model\nmodel_results(X_test, svm_cv, 'Support Vector Machines')\nsvm_results = pd.DataFrame(prediction_scorecard)\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th>prob_0</th>\n      <th>prob_1</th>\n      <th>prob_2</th>\n      <th>prediction</th>\n      <th>actual</th>\n      <th>grid_position</th>\n    </tr>\n    <tr>\n      <th>round</th>\n      <th>season</th>\n      <th>round</th>\n      <th>driverRef</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"20\" valign=\"top\">1</th>\n      <th rowspan=\"20\" valign=\"top\">2021</th>\n      <th rowspan=\"20\" valign=\"top\">1</th>\n      <th>hamilton</th>\n      <td>0.0000</td>\n      <td>1.0000</td>\n      <td>0.0000</td>\n      <td>Podium</td>\n      <td>Podium</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>max_verstappen</th>\n      <td>0.0000</td>\n      <td>1.0000</td>\n      <td>0.0000</td>\n      <td>Podium</td>\n      <td>Podium</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>bottas</th>\n      <td>0.0000</td>\n      <td>0.9989</td>\n      <td>0.0011</td>\n      <td>Podium</td>\n      <td>Podium</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>norris</th>\n      <td>0.0001</td>\n      <td>0.0106</td>\n      <td>0.9893</td>\n      <td>Top_10</td>\n      <td>Top_10</td>\n      <td>7</td>\n    </tr>\n    <tr>\n      <th>raikkonen</th>\n      <td>0.9990</td>\n      <td>0.0009</td>\n      <td>0.0001</td>\n      <td>Outside_Top_10</td>\n      <td>Outside_Top_10</td>\n      <td>14</td>\n    </tr>\n    <tr>\n      <th>giovinazzi</th>\n      <td>0.9998</td>\n      <td>0.0002</td>\n      <td>0.0000</td>\n      <td>Outside_Top_10</td>\n      <td>Outside_Top_10</td>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>ocon</th>\n      <td>0.9999</td>\n      <td>0.0001</td>\n      <td>0.0000</td>\n      <td>Outside_Top_10</td>\n      <td>Outside_Top_10</td>\n      <td>16</td>\n    </tr>\n    <tr>\n      <th>ricciardo</th>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>1.0000</td>\n      <td>Top_10</td>\n      <td>Top_10</td>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>sainz</th>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>1.0000</td>\n      <td>Top_10</td>\n      <td>Top_10</td>\n      <td>8</td>\n    </tr>\n    <tr>\n      <th>perez</th>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>1.0000</td>\n      <td>Top_10</td>\n      <td>Top_10</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>alonso</th>\n      <td>1.0000</td>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>Outside_Top_10</td>\n      <td>Outside_Top_10</td>\n      <td>9</td>\n    </tr>\n    <tr>\n      <th>stroll</th>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>1.0000</td>\n      <td>Top_10</td>\n      <td>Top_10</td>\n      <td>10</td>\n    </tr>\n    <tr>\n      <th>gasly</th>\n      <td>1.0000</td>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>Outside_Top_10</td>\n      <td>Outside_Top_10</td>\n      <td>5</td>\n    </tr>\n    <tr>\n      <th>leclerc</th>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>1.0000</td>\n      <td>Top_10</td>\n      <td>Top_10</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>vettel</th>\n      <td>1.0000</td>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>Outside_Top_10</td>\n      <td>Outside_Top_10</td>\n      <td>20</td>\n    </tr>\n    <tr>\n      <th>russell</th>\n      <td>1.0000</td>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>Outside_Top_10</td>\n      <td>Outside_Top_10</td>\n      <td>15</td>\n    </tr>\n    <tr>\n      <th>latifi</th>\n      <td>1.0000</td>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>Outside_Top_10</td>\n      <td>Outside_Top_10</td>\n      <td>17</td>\n    </tr>\n    <tr>\n      <th>tsunoda</th>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>1.0000</td>\n      <td>Top_10</td>\n      <td>Top_10</td>\n      <td>13</td>\n    </tr>\n    <tr>\n      <th>mick_schumacher</th>\n      <td>1.0000</td>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>Outside_Top_10</td>\n      <td>Outside_Top_10</td>\n      <td>18</td>\n    </tr>\n    <tr>\n      <th>mazepin</th>\n      <td>1.0000</td>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>Outside_Top_10</td>\n      <td>Outside_Top_10</td>\n      <td>19</td>\n    </tr>\n    <tr>\n      <th rowspan=\"20\" valign=\"top\">2</th>\n      <th rowspan=\"20\" valign=\"top\">2021</th>\n      <th rowspan=\"20\" valign=\"top\">2</th>\n      <th>hamilton</th>\n      <td>0.0000</td>\n      <td>1.0000</td>\n      <td>0.0000</td>\n      <td>Podium</td>\n      <td>Podium</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>max_verstappen</th>\n      <td>0.0000</td>\n      <td>1.0000</td>\n      <td>0.0000</td>\n      <td>Podium</td>\n      <td>Podium</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>norris</th>\n      <td>0.0000</td>\n      <td>0.9954</td>\n      <td>0.0046</td>\n      <td>Podium</td>\n      <td>Podium</td>\n      <td>7</td>\n    </tr>\n    <tr>\n      <th>leclerc</th>\n      <td>0.0001</td>\n      <td>0.0128</td>\n      <td>0.9871</td>\n      <td>Top_10</td>\n      <td>Top_10</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>perez</th>\n      <td>0.9987</td>\n      <td>0.0012</td>\n      <td>0.0001</td>\n      <td>Outside_Top_10</td>\n      <td>Outside_Top_10</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>tsunoda</th>\n      <td>0.9997</td>\n      <td>0.0003</td>\n      <td>0.0000</td>\n      <td>Outside_Top_10</td>\n      <td>Outside_Top_10</td>\n      <td>20</td>\n    </tr>\n    <tr>\n      <th>raikkonen</th>\n      <td>0.9999</td>\n      <td>0.0001</td>\n      <td>0.0000</td>\n      <td>Outside_Top_10</td>\n      <td>Outside_Top_10</td>\n      <td>16</td>\n    </tr>\n    <tr>\n      <th>gasly</th>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>1.0000</td>\n      <td>Top_10</td>\n      <td>Top_10</td>\n      <td>5</td>\n    </tr>\n    <tr>\n      <th>mick_schumacher</th>\n      <td>1.0000</td>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>Outside_Top_10</td>\n      <td>Outside_Top_10</td>\n      <td>18</td>\n    </tr>\n    <tr>\n      <th>latifi</th>\n      <td>1.0000</td>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>Outside_Top_10</td>\n      <td>Outside_Top_10</td>\n      <td>14</td>\n    </tr>\n    <tr>\n      <th>russell</th>\n      <td>1.0000</td>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>Outside_Top_10</td>\n      <td>Outside_Top_10</td>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>giovinazzi</th>\n      <td>1.0000</td>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>Outside_Top_10</td>\n      <td>Outside_Top_10</td>\n      <td>17</td>\n    </tr>\n    <tr>\n      <th>stroll</th>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>1.0000</td>\n      <td>Top_10</td>\n      <td>Top_10</td>\n      <td>10</td>\n    </tr>\n    <tr>\n      <th>alonso</th>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>1.0000</td>\n      <td>Top_10</td>\n      <td>Top_10</td>\n      <td>15</td>\n    </tr>\n    <tr>\n      <th>ocon</th>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>1.0000</td>\n      <td>Top_10</td>\n      <td>Top_10</td>\n      <td>9</td>\n    </tr>\n    <tr>\n      <th>sainz</th>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>1.0000</td>\n      <td>Top_10</td>\n      <td>Top_10</td>\n      <td>11</td>\n    </tr>\n    <tr>\n      <th>bottas</th>\n      <td>1.0000</td>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>Outside_Top_10</td>\n      <td>Outside_Top_10</td>\n      <td>8</td>\n    </tr>\n    <tr>\n      <th>ricciardo</th>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>1.0000</td>\n      <td>Top_10</td>\n      <td>Top_10</td>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>vettel</th>\n      <td>1.0000</td>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>Outside_Top_10</td>\n      <td>Outside_Top_10</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>mazepin</th>\n      <td>1.0000</td>\n      <td>0.0000</td>\n      <td>0.0000</td>\n      <td>Outside_Top_10</td>\n      <td>Outside_Top_10</td>\n      <td>19</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nThe best parameters for our model are:\n\n::: {.cell execution_count=21}\n``` {.python .cell-code}\nsvm_cv.best_params_\n```\n\n::: {.cell-output .cell-output-display execution_count=21}\n```\n{'svm__C': 0.1, 'svm__degree': 3, 'svm__gamma': 0.01, 'svm__kernel': 'linear'}\n```\n:::\n:::\n\n\n::: {.cell execution_count=22}\n``` {.python .cell-code}\nsvm_results\n```\n\n::: {.cell-output .cell-output-display execution_count=22}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>model</th>\n      <th>accuracy_score</th>\n      <th>precision_score</th>\n      <th>recall_score</th>\n      <th>best_params</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Support Vector Machines</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>{'svm__C': 0.1, 'svm__degree': 3, 'svm__gamma'...</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Conclusion\n- The SVM model gives out 100% accuracy, precision and recall values.\n- The ideal hyperparameters are:\n    - C = 0.1\n    - degree = 3\n    - gamma = 0.01\n    - kernel = linear\n\n",
    "supporting": [
      "SVM_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}